<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="ã€å­¦ä¹ ç¬”è®° &#x2F; é•¿æœŸæ›´æ–°ã€‘OI ä¸­çš„æ•°è®º">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€å­¦ä¹ ç¬”è®°ã€‘OIä¸­çš„æ•°è®º">
<meta property="og:url" content="http://example.com/2024/03/02/number-theory-in-oi/index.html">
<meta property="og:site_name" content="TheSky233&#39;s Blog">
<meta property="og:description" content="ã€å­¦ä¹ ç¬”è®° &#x2F; é•¿æœŸæ›´æ–°ã€‘OI ä¸­çš„æ•°è®º">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://badges.toozhao.com/badges/01GS5KXNGQGRTFRYKTZBWKNGJV/blue.svg">
<meta property="article:published_time" content="2024-03-01T20:02:38.000Z">
<meta property="article:modified_time" content="2024-03-01T20:07:58.790Z">
<meta property="article:author" content="TheSky233">
<meta property="article:tag" content="Math">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://badges.toozhao.com/badges/01GS5KXNGQGRTFRYKTZBWKNGJV/blue.svg">

<link rel="canonical" href="http://example.com/2024/03/02/number-theory-in-oi/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>ã€å­¦ä¹ ç¬”è®°ã€‘OIä¸­çš„æ•°è®º | TheSky233's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    <a target="_blank" rel="noopener" href="https://github.com/TheSky233/TheSky233.github.io" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">TheSky233's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ğ´ğ‘›ğ‘‘ ğ‘–ğ‘› ğ‘¡â„ğ‘ğ‘¡ ğ‘™ğ‘–ğ‘”â„ğ‘¡...</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/03/02/number-theory-in-oi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/501865.png">
      <meta itemprop="name" content="TheSky233">
      <meta itemprop="description" content="An OIer / PhOer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSky233's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ã€å­¦ä¹ ç¬”è®°ã€‘OIä¸­çš„æ•°è®º
        </h1>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-03-02 04:02:38 / ä¿®æ”¹æ—¶é—´ï¼š04:07:58" itemprop="dateCreated datePublished" datetime="2024-03-02T04:02:38+08:00">2024-03-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">å­¦ä¹ ç¬”è®°</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>18k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>17 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="ã€å­¦ä¹ ç¬”è®°-é•¿æœŸæ›´æ–°ã€‘OI-ä¸­çš„æ•°è®º"><a href="#ã€å­¦ä¹ ç¬”è®°-é•¿æœŸæ›´æ–°ã€‘OI-ä¸­çš„æ•°è®º" class="headerlink" title="ã€å­¦ä¹ ç¬”è®° / é•¿æœŸæ›´æ–°ã€‘OI ä¸­çš„æ•°è®º"></a>ã€å­¦ä¹ ç¬”è®° / é•¿æœŸæ›´æ–°ã€‘OI ä¸­çš„æ•°è®º</h1><span id="more"></span>
<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><ul>
<li><p><strong>Preface</strong></p>
<ul>
<li>0.1 å‰è¨€</li>
<li>0.2 å¸¸ç”¨ç¬¦å·</li>
<li>0.3 å¿«é€Ÿå¹‚</li>
</ul>
</li>
<li><p><strong>æ•°è®º</strong></p>
<ul>
<li><p>1 æ•°è®ºåŸºç¡€</p>
<ul>
<li>1.1 æ•´é™¤</li>
<li>1.2 å¸¦ä½™é™¤æ³•</li>
<li>1.3 åŒä½™</li>
<li>1.4 æ•°è®ºå‡½æ•°</li>
</ul>
</li>
<li><p>2 ç´ æ•°</p>
<ul>
<li>2.1 å”¯ä¸€åˆ†è§£å®šç†</li>
<li>2.2 åˆ¤å®šç´ æ•°</li>
<li>2.3 Miller-Rabin åˆ¤å®šç´ æ•°<ul>
<li>2.3.1 è´¹é©¬å°å®šç†</li>
<li>2.3.2 äºŒæ¬¡æ¢æµ‹å®šç†</li>
<li>2.3.3 Miller-Rabin</li>
</ul>
</li>
<li>2.4 ç´ æ•°ç­›<ul>
<li>2.4.1 åŸƒæ°ç­›</li>
<li>2.4.2 æ¬§æ‹‰ç­› / çº¿æ€§ç­›</li>
<li>2.4.3 ç­›æ³•çš„ä¸€äº›ä¼˜åŒ–</li>
</ul>
</li>
<li>2.5 åˆ†è§£è´¨å› æ•°<ul>
<li>2.5.1 æœ´ç´ ç®—æ³•</li>
<li>2.5.2 ç´ æ•°ç­›ä¼˜åŒ–</li>
<li>2.5.3 Pollard-Rho</li>
</ul>
</li>
<li>2.6 æ¬§æ‹‰å‡½æ•°<ul>
<li>2.6.1 æ€§è´¨</li>
<li>2.6.2 æ¬§æ‹‰å‡½æ•°</li>
<li>2.6.3 å¼•ç†</li>
<li>2.6.4 æ±‚ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°<ul>
<li>2.6.4.1 æœ´ç´ æ±‚æ³• </li>
<li>2.6.4.2 Pollard-Rho</li>
</ul>
</li>
<li>2.6.5 ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°</li>
</ul>
</li>
</ul>
</li>
<li><p>3 æœ€å¤§å…¬çº¦æ•°</p>
<ul>
<li>3.1 æœ€å¤§å…¬çº¦æ•°</li>
<li>3.2 æœ€å°å…¬å€æ•°</li>
<li>3.3 æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•<ul>
<li>3.3.1 ç”¨ $\text{exgcd}$ æ±‚è§£çš„ä¸€ä¸ªé—®é¢˜</li>
<li>3.3.2 æœ‰ç†æ•°å–ä½™ï¼šç”¨ $\text{exgcd}$ æ±‚è§£çš„å¦ä¸€ä¸ªé—®é¢˜</li>
<li>3.3.3 $\text{exgcd}$ ä¾‹é¢˜</li>
</ul>
</li>
</ul>
</li>
<li><p>4 æ•°è®ºåˆ†å—</p>
<ul>
<li>4.1 ç®—æ³•</li>
<li>4.2 ä¾‹é¢˜</li>
<li>4.3 ç”¨æ•°è®ºåˆ†å—è§£å†³çš„ä¸€ä¸ªé—®é¢˜</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Reference</strong></p>
</li>
</ul>
<h1 id="Preface"><a href="#Preface" class="headerlink" title="- Preface"></a>- Preface</h1><h2 id="0-1-å‰è¨€"><a href="#0-1-å‰è¨€" class="headerlink" title="0.1 å‰è¨€"></a>0.1 å‰è¨€</h2><p>æœ¬æ–‡æ„ä¸ºä½œè€…ä» $0$ å¼€å§‹å­¦ä¹ æ•°è®ºï¼ŒåŒæ—¶ä¹Ÿå¯¹ <a target="_blank" rel="noopener" href="https://oi-wiki.org/">OI Wiki</a> çš„æŸäº›å†…å®¹åšè¡¥å……è¯´æ˜ã€‚</p>
<p>å¦‚æœä½ çœ‹åˆ°æœ‰ä¸€äº›å°æ ‡é¢˜æ²¡æœ‰å†…å®¹ï¼Œå¾ˆæ­£å¸¸ï¼Œä½œè€…$\color{white}\small\textbf{ä¸}$ä¼šå¡«å‘çš„ã€‚</p>
<p>åŒæ—¶æœ¬æ–‡ç”¨äº†å¤§é‡ $\LaTeX$ï¼ŒåŠ è½½å…¬å¼è¾ƒæ…¢å±æ­£å¸¸ç°è±¡ã€‚</p>
<p>éƒ½çœ‹åˆ°è¿™äº†ä¸ç‚¹ä¸ªèµå— /kel</p>
<p><a target="_blank" rel="noopener" href="https://badges.toozhao.com/stats/01GS5KXNGQGRTFRYKTZBWKNGJV" title="Get your own page views count badge on badges.toozhao.com"><img src="https://badges.toozhao.com/badges/01GS5KXNGQGRTFRYKTZBWKNGJV/blue.svg" alt="Page Views Count"></a></p>
<h2 id="0-2-å¸¸ç”¨ç¬¦å·"><a href="#0-2-å¸¸ç”¨ç¬¦å·" class="headerlink" title="0.2 å¸¸ç”¨ç¬¦å·"></a>0.2 å¸¸ç”¨ç¬¦å·</h2><ol>
<li><p>æ•´é™¤ç¬¦å·ï¼š$x \mid y$ï¼Œè¡¨ç¤º $x$ æ•´é™¤ $y$ã€‚</p>
</li>
<li><p>å–æ¨¡ç¬¦å·ï¼š$x \bmod{y}$ï¼Œè¡¨ç¤º $x$ é™¤ä»¥ $y$ çš„ä½™æ•°ã€‚</p>
</li>
<li><p>äº’è´¨ç¬¦å·ï¼š$x \bot y$ï¼Œè¡¨ç¤º $x$ ä¸ $y$ äº’è´¨ã€‚</p>
</li>
<li><p>æœ€å¤§å…¬çº¦æ•°ï¼š$\gcd(x,y)$ æˆ– $(x,y)$ã€‚</p>
</li>
<li><p>æœ€å°å…¬å€æ•°ï¼š$\operatorname{lcm}(x,y)$ æˆ– $[x,y]$ã€‚</p>
</li>
<li><p>é˜¶ä¹˜ç¬¦å·ï¼š$n!$ï¼Œè¡¨ç¤º $1 \times 2 \times 3 \times \cdots \times n$ï¼Œç‰¹åˆ«çš„ï¼Œ$0!=1$ã€‚</p>
</li>
<li><p>æ±‚å’Œç¬¦å·ï¼š$\sum$ï¼Œè¡¨ç¤ºç‰¹å®šæ¡ä»¶ä¸‹å‡ ä¸ªæ•°çš„å’Œï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>$\sum^n_{i=1} i$ è¡¨ç¤º $1\sim n$ çš„å’Œã€‚<ul>
<li>$\sum_{x \le n,x\bot n} 1$ è¡¨ç¤º $1 \sim n$ é‡Œæœ‰å‡ ä¸ªæ•°å’Œå®ƒäº’è´¨ï¼Œå³ $\varphi(n)$ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><p>æ±‚ç§¯ç¬¦å·ï¼š$\prod$ï¼Œè¡¨ç¤ºç‰¹å®šæ¡ä»¶ä¸‹å‡ ä¸ªæ•°çš„ç§¯ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>$\prod_{i=1}^n i$ è¡¨ç¤º $n$ çš„é˜¶ä¹˜ï¼Œå³ $n!$ã€‚<ul>
<li>$\prod_{x \mid d}x$ è¡¨ç¤º $d$ çš„æ‰€æœ‰å› æ•°çš„ä¹˜ç§¯ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><p>å‘ä¸Šå–æ•´ç¬¦å·ï¼š$\lceil x \rceil$ï¼Œè¡¨ç¤ºå¤§äºç­‰äº $x$ çš„æœ€å¤§çš„æ•´æ•°ã€‚</p>
</li>
<li><p>å‘ä¸‹å–æ•´ç¬¦å·ï¼š$\lfloor x \rfloor$ï¼Œè¡¨ç¤ºå°äºç­‰äº $x$ çš„æœ€å¤§çš„æ•´æ•°ã€‚</p>
</li>
<li><p>ç»„åˆæ•°ï¼š$\binom{x}{y}$ã€‚</p>
</li>
<li><p>æ•´æ•°é›†ï¼š$\mathbf{Z}$ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„æ•´æ•°ã€‚</p>
</li>
<li><p>è‡ªç„¶æ•°é›†ï¼š$\mathbf{N}$ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„è‡ªç„¶æ•°ã€‚</p>
</li>
<li><p>å®æ•°é›†ï¼š$\mathbf{R}$ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„å®æ•°ã€‚</p>
</li>
<li><p>å­˜åœ¨ï¼š$\exists x:P(x)$ï¼Œè¡¨ç¤ºè‡³å°‘å­˜åœ¨ä¸€ä¸ª $x$ ä½¿å¾— $P(x)$ çš„å€¼ä¸ºçœŸã€‚</p>
</li>
</ol>
<h2 id="0-3-å¿«é€Ÿå¹‚-Theta-log-n"><a href="#0-3-å¿«é€Ÿå¹‚-Theta-log-n" class="headerlink" title="0.3 å¿«é€Ÿå¹‚ $\Theta(\log n)$"></a>0.3 å¿«é€Ÿå¹‚ $\Theta(\log n)$</h2><p>ä»ç†Ÿæ‚‰çš„å¿«é€Ÿå¹‚å¼€å§‹å­¦èµ·ã€‚</p>
<blockquote>
<p>é¢˜æ„ï¼šç»™å®š $a,b$ï¼Œæ±‚ $a^b$ã€‚</p>
</blockquote>
<p>æœ´ç´ ç®—æ³•æ˜¯ $\Theta(b)$ çš„ï¼Œè¾ƒæ…¢ã€‚</p>
<p>è®¾ $b$ çš„äºŒè¿›åˆ¶ä¸º $(n_tn_{t-1}\cdots n_2n_1)_2$ï¼Œè€ƒè™‘æŠŠ $b$ äºŒè¿›åˆ¶åˆ†è§£ï¼Œå³ $n_t2^{p}+n_{t-1}2^{p-1}+ \cdots + n_12^1+n_02^0$ï¼Œå…¶ä¸­ $n \in\{0,1\}$ï¼Œ$p$ ä¸ºéè´Ÿæ•´æ•°ï¼Œæ˜“å¾— $p= \lfloor \log_2n\rfloor$ã€‚</p>
<p>åˆç”±å¹‚çš„æ€§è´¨å¯å¾—ï¼Œ$a^{x+y} = a^x \times a^y$ã€‚</p>
<p>äºæ˜¯ $a^b$ å°±å¯å†™ä¸ºå¦‚ä¸‹å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
a^b &= a^{n_t2^{p}+n_{t-1}2^{p-1}+ \cdots + n_12^1+n_02^0}\\
&= a^{n_t2^{p}} \times a^{n_{t-1}2^{p-1}} \times \dots a^{n_02^0}
\end{aligned}</script><p>åˆæœ‰ $x^{2y}=x^y \cdot x^y=(x^y)^2$ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ $\log_2 n$ çš„æ—¶é—´ç®—å®Œä¸Šå¼äº†ã€‚</p>
<ul>
<li>ä¾‹å¦‚ï¼š</li>
</ul>
<script type="math/tex; mode=display">
\begin{aligned}
13&=(1101)_2\\
&=1 \times 2^3+ 1 \times2^2 + 0 \times 2^1 + 1 \times 2^0\\
\end{aligned}</script><script type="math/tex; mode=display">\downarrow</script><script type="math/tex; mode=display">
\begin{aligned}
5^{13}&=5^{2^3}\times 5^{2^2} \times 5^{2^0}\\
&=5^8 \times 5^4 \times 5^1\\
&=390625 \times 625 \times 5\\
&=1220703625

\end{aligned}</script><p>ç”±äºå–æ¨¡å¹¶ä¸å½±å“ä¹˜æ³•çš„è¿ç®—ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•ä¹Ÿå¯ä»¥æ±‚ $a^b \bmod k$ã€‚</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0.3 qpow</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T </span>= <span class="type">long</span> <span class="type">long</span>&gt; <span class="function">T <span class="title">qpow</span><span class="params">(T a, T b,<span class="type">const</span> T mod = b - <span class="number">2</span>)</span></span>&#123;</span><br><span class="line">	T ans = <span class="number">1</span>, base = a;</span><br><span class="line">	<span class="keyword">while</span>(b)&#123;</span><br><span class="line">		<span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = ans * base % mod;</span><br><span class="line">		base = base * base % mod;</span><br><span class="line">		b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ•°è®º"><a href="#æ•°è®º" class="headerlink" title="- æ•°è®º"></a>- æ•°è®º</h1><h2 id="1-æ•°è®ºåŸºç¡€"><a href="#1-æ•°è®ºåŸºç¡€" class="headerlink" title="1 æ•°è®ºåŸºç¡€"></a>1 æ•°è®ºåŸºç¡€</h2><h3 id="1-1-æ•´é™¤"><a href="#1-1-æ•´é™¤" class="headerlink" title="1.1 æ•´é™¤"></a>1.1 æ•´é™¤</h3><p>è®¾ $a,b \in \mathbf{Z},a \neq 0$ï¼Œä¸”å¦‚æœ $\exists q \in \mathbf{Z}$ï¼Œä½¿å¾— $b = aq$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯´ $a$ æ•´é™¤ $b$ï¼Œæˆ–è€… $b$ èƒ½è¢« $a$ æ•´é™¤ï¼Œè®°ä½œ $a \mid b$ï¼Œå…¶ä¸­ $b$ æ˜¯ $a$ çš„å€æ•°ï¼Œ$a$ æ˜¯ $b$ çš„å› æ•°ã€‚</p>
<p>å¦åˆ™æˆ‘ä»¬å°±ç§° $b$ ä¸èƒ½è¢« $a$ æ•´é™¤ï¼Œè®°ä½œ $a \nmid b$ã€‚</p>
<p>æ€§è´¨ï¼š</p>
<ul>
<li>$a \mid b = -a \mid b = a \mid -b = |a| \mid |b|$ã€‚</li>
<li>$a \mid b \land b \mid c \implies a \mid c$</li>
<li>$a\mid b\land a\mid c\iff\forall x,y\in\mathbf{Z}, a\mid(xb+yc)$</li>
<li>$a\mid b\land b\mid a\implies b=\pm a$</li>
<li>è®¾ $m \neq 0$ï¼Œåˆ™ $a\mid b\iff ma\mid mb$ã€‚</li>
<li>è®¾ $b \ne 0$ï¼Œé‚£ä¹ˆ $a \mid b \implies |a| \le |b|$ã€‚</li>
<li>è®¾ $a \ne 0,b=qa+c$ï¼Œé‚£ä¹ˆ $a \mid b \iff a \mid c$ã€‚</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/paste/knj1l608">ä»¥ä¸Šæ€§è´¨çš„è¯æ˜</a>ã€‚</p>
<p>å¯¹äºæ•´æ•° $b \ne 0$ï¼Œ$b$ çš„çº¦æŸåªæœ‰æœ‰é™ä¸ªï¼Œ$0$ æ˜¯ä»»ä½•ä¸ç­‰äº $0$ çš„æ•´æ•°çš„å€æ•°ã€‚</p>
<p>å¯¹äºæ•´æ•° $b \ne 0,1$ï¼Œ$b$ æœ‰å››ä¸ªæ˜¾ç„¶å› æ•°ä¸º $\pm 1,\pm b$ï¼Œç‰¹åˆ«çš„ï¼Œ$1$ åªæœ‰ä¸¤ä¸ªæ˜¾ç„¶å› æ•°ã€‚</p>
<p>å¯¹äºæ•´æ•° $b \ne 0$ çš„çœŸå› æ•°ç§°ä¸º $b$ éæ˜¾ç„¶å› æ•°çš„å› æ•°ã€‚</p>
<ul>
<li>è®¾ $b\ne 0$ï¼Œé‚£ä¹ˆå½“ $d$ éå† $b$ çš„å› æ•°çš„æ—¶å€™ï¼Œ$\frac{b}{d}$ ä¹Ÿåœ¨éå† $b$ çš„å› æ•°ã€‚</li>
<li>è®¾ $b&gt; 0$ï¼Œé‚£ä¹ˆå½“ $d$ éå† $b$ çš„æ­£å› æ•°çš„æ—¶å€™ï¼Œ$\frac{b}{d}$ ä¹Ÿåœ¨éå† $b$ çš„æ­£å› æ•°ã€‚</li>
</ul>
<h3 id="1-2-å¸¦ä½™é™¤æ³•"><a href="#1-2-å¸¦ä½™é™¤æ³•" class="headerlink" title="1.2 å¸¦ä½™é™¤æ³•"></a>1.2 å¸¦ä½™é™¤æ³•</h3><p>è®¾ $a,b \in \mathbf{Z}$ï¼Œ$a \neq 0$ï¼Œåˆ™æœ‰ $b=qa+r$ï¼Œå…¶ä¸­ $q=\left\lfloor \dfrac{b}{a} \right\rfloor,0 \le r \le |a|$ã€‚</p>
<p>è¿™é‡Œçš„ $r$ è¢«ç§°ä¸ºæœ€å°éè´Ÿä½™æ•°ï¼Œä¹Ÿå¯ä»¥å†™æˆ $r = b\bmod{a}$ã€‚</p>
<p>å…¶ä¸­ $r=b-aq=b-a\left\lfloor\dfrac{b}{a}\right\rfloor$ã€‚</p>
<p><strong>æ€§è´¨</strong></p>
<ul>
<li>è¿ç»­ $a$ ä¸ªæ•´æ•°é™¤ä»¥ $a$ï¼Œä½™æ•°ä¸€å®šä¸”æ­£å¥½å–åˆ° $0 \sim a-1$ å„ä¸€ä¸ªï¼Œå…¶ä¸­<strong>æœ‰ä¸”ä»…æœ‰</strong>ä¸€ä¸ªæ­£å¥½è¢« $a$ æ•´é™¤ã€‚</li>
<li>ä»»ä½•ä¸€ä¸ªæ•´æ•°é™¤ä»¥ $a$ï¼Œä½™æ•°ä¸€å®šä¸º $0 \sim a-1$ å…¶ä¸­ä¸€ä¸ªã€‚</li>
</ul>
<h3 id="1-3-åŒä½™"><a href="#1-3-åŒä½™" class="headerlink" title="1.3 åŒä½™"></a>1.3 åŒä½™</h3><h3 id="1-4-æ•°è®ºå‡½æ•°"><a href="#1-4-æ•°è®ºå‡½æ•°" class="headerlink" title="1.4 æ•°è®ºå‡½æ•°"></a>1.4 æ•°è®ºå‡½æ•°</h3><h3 id="1-4-1-ç§¯æ€§å‡½æ•°"><a href="#1-4-1-ç§¯æ€§å‡½æ•°" class="headerlink" title="1.4.1 ç§¯æ€§å‡½æ•°"></a>1.4.1 ç§¯æ€§å‡½æ•°</h3><p>æŒ‡çš„æ˜¯å¦‚æœ $\forall x,y\in\mathbf{N}^*,\gcd(x,y)=1$ ä¸” $f(1)=1$ï¼Œé‚£ä¹ˆ $f(x\times y)=f(x) \times f(y)$ã€‚</p>
<p>ç‰¹æ®Šçš„ï¼Œå¦‚æœ $\forall x,y\in\mathbf{N}^<em>$ ä¸” $f(1)=1$ï¼Œé‚£ä¹ˆ $f(x\times y)=f(x) \times f(y)$ï¼Œåˆ™ç§° $f(n)$ ä¸º<em>*å®Œå…¨</em></em>ç§¯æ€§å‡½æ•°ã€‚</p>
<ul>
<li>å¦‚æ¬§æ‹‰å‡½æ•° $\varphi(a\times b)=\varphi(a) \times \varphi(b)\ \{\gcd(a,b)=1\}$</li>
</ul>
<h2 id="2-ç´ æ•°"><a href="#2-ç´ æ•°" class="headerlink" title="2 ç´ æ•°"></a>2 ç´ æ•°</h2><p>å®šä¹‰ï¼šè‹¥æ•´æ•° $b \ne 0, \pm1$ åªæœ‰å››ä¸ªæ˜¾ç„¶å› æ•°çš„æ—¶å€™ï¼Œ$b$ æ˜¯ç´ æ•°ï¼Œå¦åˆ™ $b$ æ˜¯åˆæ•°ã€‚</p>
<p>$\pm b$ æ€»æ˜¯åŒä¸ºç´ æ•°æˆ–åŒä¸ºåˆæ•°ã€‚<strong>ç‰¹åˆ«çš„ï¼Œè‹¥æ— ç‰¹æ®Šè¯´æ˜ï¼Œåˆ™ç´ æ•°æŒ‡æ­£ç´ æ•°</strong>ã€‚</p>
<h3 id="2-1-å”¯ä¸€åˆ†è§£å®šç†"><a href="#2-1-å”¯ä¸€åˆ†è§£å®šç†" class="headerlink" title="2.1 å”¯ä¸€åˆ†è§£å®šç†"></a>2.1 å”¯ä¸€åˆ†è§£å®šç†</h3><ul>
<li>åˆæ•°æ€»èƒ½åˆ†è§£æˆå‡ ä¸ªç´ æ•°çš„ä¹˜ç§¯ã€‚</li>
</ul>
<p>å½¢å¼åŒ–çš„ï¼Œè®¾ $a$ ä¸ºåˆæ•°ï¼Œ$p$ ä¸ºç´ æ•°é›†ï¼Œåˆ™</p>
<script type="math/tex; mode=display">a=p_1^{\alpha_1}p_2^{\alpha_2}\cdots p_n^{\alpha_n}</script><ul>
<li>ä¾‹å¦‚</li>
</ul>
<script type="math/tex; mode=display">
\begin{aligned}
24&=2 \times 2 \times 2 \times 3\\
&=2^3 \times 3^1
\end{aligned}</script><ul>
<li>åº”ç”¨ï¼š<a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc280/tasks/abc280_d">https://atcoder.jp/contests/abc280/tasks/abc280_d</a></li>
</ul>
<h3 id="2-2-åˆ¤å®šç´ æ•°-Theta-sqrt-n"><a href="#2-2-åˆ¤å®šç´ æ•°-Theta-sqrt-n" class="headerlink" title="2.2 åˆ¤å®šç´ æ•° $\Theta(\sqrt{n})$"></a>2.2 åˆ¤å®šç´ æ•° $\Theta(\sqrt{n})$</h3><p>é€šè¿‡ç´ æ•°çš„æ€§è´¨å¯çŸ¥ï¼Œå¯¹äºç´ æ•° $n$ï¼Œ$\forall k\in \mathbb{Z},k \in[2,n)$ï¼Œæœ‰ $ k \nmid n$ï¼Œäºæ˜¯ä¸éš¾æƒ³åˆ°ä¸€ä¸ª $\Theta(n)$ çš„æœ´ç´ ç¨‹åºï¼Œç”¨ $2 \sim n-1$ çš„æ‰€æœ‰æ­£æ•´æ•°å¯¹ $n$ è¿›è¡Œè¯•é™¤ï¼Œå¦‚æœ $n \bmod{k}=0$ï¼Œè¯´æ˜ $p$ é™¤äº†æ˜¾ç„¶å› æ•°å¤–ï¼Œè¿˜æœ‰ $k$ å’Œ $\frac{n}{k}$ çš„å› æ•°ï¼Œå› æ­¤åˆ¤å®šä¸ºåˆæ•°ã€‚</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.2.2 prime check O(n)</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check_linear</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; x; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(x % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç„¶ï¼Œå½“ $n$ åˆ° $10^{9}$ çº§åˆ«æ—¶ï¼Œæ­¤ç§æ–¹æ³•ä¾¿ä¼šè¶…æ—¶ã€‚</p>
<p>æ³¨æ„åˆ° $1.1$ çš„ä¸€å¥è¯ï¼š<strong>è®¾ $b&gt; 0$ï¼Œé‚£ä¹ˆå½“ $d$ éå† $b$ çš„æ­£å› æ•°çš„æ—¶å€™ï¼Œ$\frac{b}{d}$ ä¹Ÿåœ¨éå† $b$ çš„æ­£å› æ•°ã€‚</strong></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ $k$ è®¿é—®åˆ° $\sqrt{n}$ çš„æ—¶å€™ï¼Œå¦‚æœæ­¤æ—¶è¿˜å­˜åœ¨ $n \bmod{k}=0$ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šåœ¨è®¿é—®åˆ° $\frac{n}{k}$ çš„æ—¶å€™è¢«åˆ¤å®šä¸ºåˆæ•°ï¼Œå› æ­¤ï¼Œ$\sqrt{n}$ ä¹‹åçš„åˆ¤å®šå®Œå…¨æ˜¯å¤šä½™çš„ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¾¿å¯é™åˆ° $\Theta(\sqrt{n})$ çº§åˆ«ã€‚</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.2.2 prime check O(sqrt(n))</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check_sqrt</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= x; i++)&#123; <span class="comment">//æ³¨æ„è¿™é‡Œæ˜¯ &lt;=xï¼Œä¸ç„¶å¯èƒ½æŠŠä¸€äº›å®Œå…¨å¹³æ–¹æ•°æ”¾è¿‡å»</span></span><br><span class="line">		<span class="keyword">if</span>(x % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-Miller-Rabin-åˆ¤å®šç´ æ•°-Theta-k-log-3n"><a href="#2-3-Miller-Rabin-åˆ¤å®šç´ æ•°-Theta-k-log-3n" class="headerlink" title="2.3 Miller-Rabin åˆ¤å®šç´ æ•° $\Theta(k \log^3n)$"></a>2.3 Miller-Rabin åˆ¤å®šç´ æ•° $\Theta(k \log^3n)$</h3><p>æœ‰æ—¶å€™ï¼Œè¦åˆ¤å®šçš„æ•°çš„çº§åˆ«æ˜¯ $10^{18}$ çº§åˆ«çš„ï¼Œè¿™æ—¶å€™ $\Theta(\sqrt{n})$ çš„ <code>check_sqrt</code> å°±ä¼š TLEï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œ Miller-Rabin ç´ æ•°æµ‹è¯•ï¼Œæ¥åˆ¤æ–­å…¶æ˜¯å¦ä¸ºç´ æ•°ã€‚</p>
<h4 id="2-3-1-è´¹é©¬å°å®šç†ï¼ˆFermatâ€™s-Little-Theoremï¼‰"><a href="#2-3-1-è´¹é©¬å°å®šç†ï¼ˆFermatâ€™s-Little-Theoremï¼‰" class="headerlink" title="2.3.1 è´¹é©¬å°å®šç†ï¼ˆFermatâ€™s Little Theoremï¼‰"></a>2.3.1 è´¹é©¬å°å®šç†ï¼ˆFermatâ€™s Little Theoremï¼‰</h4><blockquote>
<p>æœ‰è´¨æ•° $p$ï¼Œåˆ™å¯¹äºæ­£æ•´æ•° $a \nmid p$ï¼Œæœ‰ $a^{p-1} \equiv 1\pmod{p}$ã€‚</p>
</blockquote>
<p>è€ƒè™‘å®ƒçš„é€†å¦å‘½é¢˜ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ç§åˆ¤æ–­ç´ æ•°çš„æ–¹æ³•ï¼š</p>
<blockquote>
<p>å¦‚æœ $a^{p-1} \not \equiv 1 \pmod{p}$ï¼Œåˆ™ $p$ ä¸æ˜¯ç´ æ•°ã€‚</p>
</blockquote>
<ul>
<li>æ³¨æ„ FLT çš„é€†å®šç†æ˜¯ä¸æˆç«‹çš„ï¼Œå³å¯¹äºæ­£æ•´æ•° $1 \le a &lt;p$ï¼Œæœ‰ $a^{p-1} \equiv 1\pmod{p}$ï¼Œåˆ™ $p$ æ˜¯è´¨æ•°ï¼Œä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯ <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8D%A1%E8%BF%88%E5%85%8B%E5%B0%94%E6%95%B0/9083263?fromModule=lemma_inlink">$\text{Carmichael}$ æ•°</a>ã€‚</li>
</ul>
<h4 id="2-3-2-äºŒæ¬¡æ¢æµ‹å®šç†"><a href="#2-3-2-äºŒæ¬¡æ¢æµ‹å®šç†" class="headerlink" title="2.3.2 äºŒæ¬¡æ¢æµ‹å®šç†"></a>2.3.2 äºŒæ¬¡æ¢æµ‹å®šç†</h4><p>å¯¹äºä¸Šé¢çš„ $\text{Carmichael}$ æ•°ï¼ŒFLT ä¸èƒ½åˆ¤æ–­å…¶ç´ æ€§ã€‚æ­¤æ—¶å°±å¯ä»¥ç”¨åˆ°<strong>äºŒæ¬¡æ¢æµ‹å®šç†</strong>ã€‚</p>
<blockquote>
<p>å¦‚æœ $p$ æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œ$0 &lt; x &lt; p$ï¼Œé‚£ä¹ˆ $x^2 \equiv 1 \pmod{p}$ çš„è§£åªæœ‰ä¸¤ä¸ªï¼š$x_1=1,x_2=p-1$ã€‚</p>
</blockquote>
<p>è¯æ˜ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
x^2 \equiv 1 \pmod{p}\\
x^2-1 \equiv 0 \pmod{p}\\
(x+1)(x-1) \equiv 0\pmod{p}
\end{aligned}</script><p>äºæ˜¯æœ‰ $(x+1)(x-1) \mid p$ï¼Œæ•…å¾—å‡º $1 \sim p-1$ çš„æ­£æ•´æ•°åªæœ‰ $1$ å’Œ $p-1$ ä¸¤ä¸ªè§£ï¼Œæ•…åŸå‘½é¢˜å¾—è¯ã€‚</p>
<h4 id="2-3-3-Miller-Rabin"><a href="#2-3-3-Miller-Rabin" class="headerlink" title="2.3.3 Miller-Rabin"></a>2.3.3 Miller-Rabin</h4><p>äºæ˜¯æˆ‘ä»¬æœ‰äº†ä¸€ç§åˆ¤å®šç´ æ•°çš„æ–¹æ³•ï¼šMiller-Rabinã€‚</p>
<p>å…·ä½“æ­¥éª¤ï¼š</p>
<ol>
<li>å¦‚æœ $n=1$ æˆ– $n \bmod{2}=0$ï¼Œç›´æ¥è¿”å› <code>false</code>;</li>
<li>æŠŠ $a^{n-1}$ åŒ–æˆ $(a^{\frac{n-1}{2}})^2,(a^{\frac{n-1}{4}})^{2^2}$ çš„å½¢å¼ï¼Œç›´åˆ°ä¸èƒ½åŒ–ä¸ºæ­¢ï¼Œè®¾æœ€åçš„åº•æ•°ä¸º $a^u$ã€‚</li>
<li>é€‰æ‹©ç´ æ•° $a$ï¼Œè®¡ç®— $a^u \bmod n$ã€‚</li>
<li>ä¸æ–­è¿ç”¨äºŒæ¬¡æ¢æµ‹å®šç†ï¼Œåˆ¤æ–­å½“ $x^2 \equiv 1 \pmod{p}$ æˆç«‹æ—¶ï¼Œæ˜¯å¦ $x=1$ æˆ– $x=n-1$ï¼Œå¦‚æœä¸æ˜¯å³æ¢æµ‹å¤±è´¥ï¼Œè¿”å› <code>false</code>ã€‚</li>
<li>å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œå°±åˆ¤æ–­ $a^{n-1} \equiv1\pmod{p}$ æ˜¯å¦æˆç«‹ï¼Œå¦‚æˆç«‹ï¼Œåˆ™<strong>è¿™ä¸€è½®</strong> Miller-Rabin æ£€æµ‹ç»“æŸã€‚</li>
</ol>
<p>ä¸€èˆ¬æ¥è¯´ç´ æ•° $a$ çš„é€‰æ‹©åœ¨ <code>long long</code> èŒƒå›´å†…é€‰æ‹© $2,3,5,7,11,13,17,19,23$ è¿™ä¹ä¸ªæ•°å³å¯ $100\%$ æ­£ç¡®ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼š$\Theta(k \log^3n)$ï¼Œ$k$ å³ä¸ºé€‰æ‹©äº†å‡ ä¸ªç´ æ•°è¿›è¡Œæ£€æµ‹ã€‚</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.2.3.3 Miller-Rabin</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">double</span> ld;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll mod)</span></span>&#123;</span><br><span class="line"><span class="comment">// å¿«é€Ÿä¹˜ï¼ŒåŸç†æ˜¯ç”¨ ull çš„æº¢å‡ºè§£å†³ ll çš„æº¢å‡º</span></span><br><span class="line">    ll c=(ld)a/mod*b;</span><br><span class="line">    ll res=(ull)a*b-(ull)c*mod;</span><br><span class="line">    <span class="keyword">return</span> (res+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b,<span class="type">const</span> ll p)</span></span>&#123;</span><br><span class="line"><span class="comment">// å¿«é€Ÿå¹‚</span></span><br><span class="line">	ll ans=<span class="number">1ll</span>,base=a;</span><br><span class="line">	<span class="keyword">while</span>(b)&#123;</span><br><span class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans=<span class="built_in">mul</span>(ans,base,p);</span><br><span class="line">		base=<span class="built_in">mul</span>(base,base,p);</span><br><span class="line">		b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll ud[]=&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>&#125;; <span class="comment">// ç´ æ•°é›†</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">MRtest</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n%<span class="number">2</span>==<span class="number">0</span> || n&lt;<span class="number">3</span>) <span class="keyword">return</span> n==<span class="number">2</span>; <span class="comment">// ç‰¹åˆ¤</span></span><br><span class="line">	ll u=n<span class="number">-1</span>,t=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(u%<span class="number">2</span>==<span class="number">0</span>) u&gt;&gt;=<span class="number">1</span>,++t; <span class="comment">// åˆ†è§£ä¸º a^u</span></span><br><span class="line">	ll x,pre;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> p:ud)&#123; <span class="comment">// é€‰æ‹©ç´ æ•°</span></span><br><span class="line">		<span class="keyword">if</span>(p==n) <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// ç‰¹åˆ¤</span></span><br><span class="line">		x=<span class="built_in">qpow</span>(p,u,n);</span><br><span class="line">		pre=x;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=t;i++)&#123;</span><br><span class="line">			x=<span class="built_in">mul</span>(x,x,n);</span><br><span class="line">			<span class="keyword">if</span>(x==<span class="number">1</span> &amp;&amp; pre!=<span class="number">1</span> &amp;&amp; pre!=n<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			pre=x; <span class="comment">// äºŒæ¬¡æ¢æµ‹</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(x!=<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// è´¹é©¬å°å®šç†</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åº”ç”¨ï¼š<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/U82118">https://www.luogu.com.cn/problem/U82118</a></li>
</ul>
<h2 id="2-4-ç´ æ•°ç­›"><a href="#2-4-ç´ æ•°ç­›" class="headerlink" title="2.4 ç´ æ•°ç­›"></a>2.4 ç´ æ•°ç­›</h2><p>é€šè¿‡ $1.2.1$ çš„ç´ æ•°åˆ¤å®šï¼Œæˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•åˆ¤å®šä¸€ä¸ªæ•°æ˜¯å¦æ˜¯ç´ æ•°ï¼Œä½†æ˜¯ï¼Œå¦‚æœè¦åˆ¤æ–­ $1 \sim n$ ä¸­æ‰€æœ‰çš„æ•°æ˜¯å¦æ˜¯ç´ æ•°å‘¢ï¼Ÿ</p>
<p>ä¸€ä¸ªæ˜¾ç„¶çš„åšæ³•æ˜¯æ‰«ä¸€éåŒºé—´ï¼Œç”¨æ ¹å·åšæ³•æˆ–è€… Miller-Rabin åˆ¤æ–­æ¯ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯ç´ æ•°ï¼Œä½†æ˜¯ $\Theta(n \sqrt{n})$ æˆ– $\Theta(n k\log^3 n)$ çš„å¤æ‚åº¦æ˜¾ç„¶å¤ªæ…¢ï¼Œäºæ˜¯æˆ‘ä»¬å¼•è¿›äº†ç´ æ•°ç­›çš„æ€æƒ³ã€‚</p>
<h3 id="2-4-1-åŸƒæ°ç­›-Theta-n-log-log-n"><a href="#2-4-1-åŸƒæ°ç­›-Theta-n-log-log-n" class="headerlink" title="2.4.1 åŸƒæ°ç­› $\Theta(n \log \log n)$"></a>2.4.1 åŸƒæ°ç­› $\Theta(n \log \log n)$</h3><p>ç”±<strong>å”¯ä¸€åˆ†è§£å®šç†ï¼ˆ$2.1$ï¼‰</strong>ï¼Œæ¯ä¸ªåˆæ•°éƒ½å¯ä»¥è¢«åˆ†è§£æˆè‹¥å¹²ä¸ªè´¨æ•°çš„ä¹˜ç§¯ï¼Œæ¢å¥è¯è¯´ï¼Œ<strong>æ¯ä¸ªåˆæ•°éƒ½æ˜¯å®ƒçš„è´¨å› æ•°çš„å€æ•°</strong>ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·ä¸€ç§ç­›æ³•ï¼ˆåŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•ï¼Œç®€ç§°åŸƒæ°ç­›ï¼‰ï¼šå»ºç«‹ä¸€ä¸ªæ ‡è®°æ•°ç»„ <code>vis</code>ï¼Œæ¯æ¬¡ä»å°åˆ°å¤§é€‰æ‹©æœªè¢«æ ‡è®°çš„æ•°ï¼ŒæŠŠå®ƒçš„å€æ•°éƒ½æ ‡è®°ä¸ºåˆæ•°ï¼Œè¿™æ ·åœ¨ç»“æŸåæœªè¢«æ ‡è®°çš„æ•°å°±æ˜¯ç´ æ•°ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ä¸º $\Theta(n \log \log n)$ï¼Œè¿‘ä¹çº¿æ€§ã€‚</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.2.4.1 Eratosthenes sieve</span></span><br><span class="line"><span class="type">bool</span> vis[<span class="number">1000005</span>]; <span class="comment">//æ ‡è®°æ­¤æ•°æ˜¯ä¸æ˜¯ç´ æ•°</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; prime; <span class="comment">//ç´ æ•°é›†</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Eratosthenes_sieve</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(vis[i] == <span class="number">0</span>)&#123;</span><br><span class="line">			prime.<span class="built_in">push_back</span>(i);</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = i + i; j &lt;= n; j += i)&#123;</span><br><span class="line">				vis[j] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-4-2-æ¬§æ‹‰ç­›-çº¿æ€§ç­›-Theta-n"><a href="#2-4-2-æ¬§æ‹‰ç­›-çº¿æ€§ç­›-Theta-n" class="headerlink" title="2.4.2 æ¬§æ‹‰ç­› / çº¿æ€§ç­› $\Theta(n)$"></a>2.4.2 æ¬§æ‹‰ç­› / çº¿æ€§ç­› $\Theta(n)$</h3><p>Eratosthenes sieve å·²ç»è¶³å¤Ÿå¿«äº†ï¼Œä½†æ˜¯ç¢°åˆ°ä¸€äº› $n=10^7$ çš„ç­›å°±æ˜¾ç„¶ä¼š TLEã€‚ç»§ç»­æ”¹è¿›ç®—æ³•ã€‚</p>
<p>æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨åŸƒæ°ç­›ä¸­ï¼Œ$42$ è¢«ç­›äº†ä¸‰éï¼ˆåˆ†åˆ«ä¸º $2,3,7$ï¼‰ï¼Œæ¯”è¾ƒè€—è´¹æ—¶é—´ï¼Œäº‹å®ä¸Šï¼Œå¦‚æœä¸€ä¸ªæ•°åªè¢«è¢«å…¶æœ€å°çš„ç´ å› å­ç­›ä¸€æ¬¡ï¼Œé‚£ä¹ˆå¤æ‚åº¦å°±ä¼šé™åˆ° $\Theta(n)$ï¼Œæ­¤ç§æ–¹æ³•è¢«ç§°ä½œæ¬§æ‹‰ç­›æˆ–çº¿æ€§ç­›ï¼Œè§ä»£ç ï¼š</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.2.4.2 Euler sieve</span></span><br><span class="line"><span class="type">bool</span> vis[<span class="number">1000005</span>];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; prime;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler_sieve</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!vis[i]) prime.<span class="built_in">push_back</span>(i);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; (<span class="type">size_t</span>)j &lt; prime.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">			<span class="type">int</span> it = prime.<span class="built_in">at</span>(j);</span><br><span class="line">			<span class="keyword">if</span>(<span class="number">1ll</span> * it * i &gt; n) <span class="keyword">break</span>;</span><br><span class="line">			vis[<span class="number">1ll</span> * it * i] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(i % it == <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="comment">// i % pri[j] == 0</span></span><br><span class="line">		        <span class="comment">// æ¢è¨€ä¹‹ï¼Œi ä¹‹å‰è¢« pri[j] ç­›è¿‡äº†</span></span><br><span class="line">		        <span class="comment">// ç”±äº pri é‡Œé¢è´¨æ•°æ˜¯ä»å°åˆ°å¤§çš„ï¼Œæ‰€ä»¥ i ä¹˜ä¸Šå…¶ä»–çš„è´¨æ•°çš„ç»“æœä¸€å®šä¹Ÿæ˜¯</span></span><br><span class="line">		        <span class="comment">// pri[j] çš„å€æ•° å®ƒä»¬éƒ½è¢«ç­›è¿‡äº†ï¼Œå°±ä¸éœ€è¦å†ç­›äº†ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ break</span></span><br><span class="line">		        <span class="comment">// æ‰å°±å¥½äº†</span></span><br><span class="line">		        <span class="comment">// From OI-Wiki</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åº”ç”¨ï¼š<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3383">https://www.luogu.com.cn/problem/P3383</a></li>
</ul>
<h3 id="2-4-3-ç­›æ³•çš„ä¸€äº›ä¼˜åŒ–"><a href="#2-4-3-ç­›æ³•çš„ä¸€äº›ä¼˜åŒ–" class="headerlink" title="2.4.3 ç­›æ³•çš„ä¸€äº›ä¼˜åŒ–"></a>2.4.3 ç­›æ³•çš„ä¸€äº›ä¼˜åŒ–</h3><ul>
<li>ç©ºé—´ä¼˜åŒ–ï¼šå½“ç©ºé—´é™åˆ¶å¾ˆç´§çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨ <code>std::bitset</code> ä»£æ›¿ <code>bool</code> æ•°ç»„èŠ‚çœç©ºé—´ï¼Œä½†æ˜¯è¿™ä¼šä½¿ç¨‹åºæ•ˆç‡é™ä½ï¼Œå¯èƒ½ä¼š TLEï¼ˆä»¥ç©ºé—´æ¢æ—¶é—´ï¼‰ã€‚</li>
</ul>
<h2 id="2-5-åˆ†è§£è´¨å› æ•°"><a href="#2-5-åˆ†è§£è´¨å› æ•°" class="headerlink" title="2.5 åˆ†è§£è´¨å› æ•°"></a>2.5 åˆ†è§£è´¨å› æ•°</h2><p>ç»™å®šä¸€ä¸ªæ•° $n \in \mathbf{N}^+$ï¼Œåˆ†è§£å‡ºå®ƒçš„è´¨å› æ•°ã€‚</p>
<h3 id="2-5-1-æœ´ç´ ç®—æ³•-Theta-sqrt-n"><a href="#2-5-1-æœ´ç´ ç®—æ³•-Theta-sqrt-n" class="headerlink" title="2.5.1 æœ´ç´ ç®—æ³• $\Theta(\sqrt{n})$"></a>2.5.1 æœ´ç´ ç®—æ³• $\Theta(\sqrt{n})$</h3><p>æ ¹æ®<strong>å”¯ä¸€åˆ†è§£å®šç†</strong>ï¼Œä¸€ä¸ªåˆæ•°æ€»èƒ½è¢«åˆ†è§£æˆå‡ ä¸ªç´ æ•°çš„ä¹˜ç§¯ï¼Œäºæ˜¯æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªç±»ä¼¼æ ¹å·æ—¶é—´å†…åˆ¤å®šç´ æ•°çš„ç¨‹åºï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¹Ÿä¸º $\Theta(\sqrt n)$ã€‚</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; <span class="built_in">factor</span>(ll x)&#123; <span class="comment">// è¿”å›ä¸€ä¸ª pair&lt;int,int&gt; ç±»å‹çš„ vector</span></span><br><span class="line">	vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; v; <span class="comment">// first å­˜å‚¨ç´ å› å­ï¼Œsecond å­˜å‚¨ç´ å› å­çš„æ¬¡æ•°</span></span><br><span class="line">	<span class="keyword">for</span>(ll i=<span class="number">2</span>;i*i&lt;=x;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(x%i==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="type">int</span> t=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(x%i==<span class="number">0</span>) t++,x/=i;</span><br><span class="line">			v.<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(i,t));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(x&gt;<span class="number">1</span>) v.<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(x,<span class="number">1</span>)); <span class="comment">// å¦‚æœ x æœ¬èº«å°±æ˜¯ä¸ªç´ æ•°</span></span><br><span class="line">	<span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-5-2-ç´ æ•°ç­›ä¼˜åŒ–-Theta-sqrt-frac-n-ln-n"><a href="#2-5-2-ç´ æ•°ç­›ä¼˜åŒ–-Theta-sqrt-frac-n-ln-n" class="headerlink" title="2.5.2 ç´ æ•°ç­›ä¼˜åŒ– $\Theta(\sqrt{\frac{n}{\ln n}})$"></a>2.5.2 ç´ æ•°ç­›ä¼˜åŒ– $\Theta(\sqrt{\frac{n}{\ln n}})$</h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œ$n$ ä¹‹å†…çš„ç´ æ•°ä¸ªæ•°å¤§çº¦ä¸º $\dfrac{n}{\ln n}$ ä¸ªï¼Œæˆ‘ä»¬å¦‚æœäº‹å…ˆæŠŠè¿™äº›ç´ æ•°ç­›å‡ºæ¥å†åŠ ä¸Šä¸Šé¢æœ´ç´ ç®—æ³•å°±èƒ½åšåˆ°ä»¥ä¸Šçš„å¤æ‚åº¦ã€‚</p>
<p>ä»£ç å’Œä¸Šæ–‡å‡ ä¹ä¸€æ ·ï¼Œåªæ˜¯æŠŠ $i$ æ”¾åˆ°ç´ æ•°é›†é‡Œé¢å¾ªç¯ï¼Œä»£ç å°±ä¸æ”¾äº†ã€‚</p>
<ul>
<li>å®é™…ä¸Šï¼Œç­›å‡ºç´ æ•°ä¹Ÿéœ€è¦ $\Theta(n)$ çš„æ—¶é—´ï¼Œæ‰€ä»¥å¦‚æœ $n$ å¾ˆå¤§ï¼Œè¿˜æ˜¯å¾—é€‰æ‹©æ›´ä¼˜ç§€çš„ç®—æ³•ï¼Œå¦‚ä¸‹æ–‡ä»‹ç»çš„ <em>Pollard-Rho</em>ã€‚</li>
</ul>
<h3 id="2-5-3-Pollard-Rho-Theta-n-frac-1-4"><a href="#2-5-3-Pollard-Rho-Theta-n-frac-1-4" class="headerlink" title="2.5.3 Pollard-Rho $\Theta(n^{\frac{1}{4}})$"></a>2.5.3 Pollard-Rho $\Theta(n^{\frac{1}{4}})$</h3><h2 id="2-6-æ¬§æ‹‰å‡½æ•°-varphi-n"><a href="#2-6-æ¬§æ‹‰å‡½æ•°-varphi-n" class="headerlink" title="2.6 æ¬§æ‹‰å‡½æ•° $\varphi(n)$"></a>2.6 æ¬§æ‹‰å‡½æ•° $\varphi(n)$</h2><h3 id="2-6-1-æ€§è´¨"><a href="#2-6-1-æ€§è´¨" class="headerlink" title="2.6.1 æ€§è´¨"></a>2.6.1 æ€§è´¨</h3><p>é¦–å…ˆæœ‰æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ $\gcd(a,b)=1$ï¼Œæœ‰ $\varphi(a \times b)=\varphi(a) \times \varphi(b)$ã€‚</p>
<p>ç”±ç´ æ•°å®šä¹‰å¯çŸ¥ï¼Œå¦‚æœ $p$ ä¸ºç´ æ•°ï¼Œ$\varphi(p)=p-1$ã€‚</p>
<h3 id="2-6-2-æ¬§æ‹‰å‡½æ•°ï¼ˆEulerâ€™s-totient-functionï¼‰"><a href="#2-6-2-æ¬§æ‹‰å‡½æ•°ï¼ˆEulerâ€™s-totient-functionï¼‰" class="headerlink" title="2.6.2 æ¬§æ‹‰å‡½æ•°ï¼ˆEulerâ€™s totient functionï¼‰"></a>2.6.2 æ¬§æ‹‰å‡½æ•°ï¼ˆEulerâ€™s totient functionï¼‰</h3><p>å‡­å€Ÿ <strong>2.6.1</strong> å’Œ <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/501865/number-theory-in-oi#:~:text=2.1"><strong>2.1 å”¯ä¸€åˆ†è§£å®šç†</strong></a><br>äºæ˜¯æˆ‘ä»¬å°±æœ‰äº†æ¬§æ‹‰å‡½æ•°çš„è®¡ç®—æ–¹æ³•ï¼Œè®¾åˆæ•° $n=\prod^s_{i=1} p_i^{k_i}$ï¼Œåˆ™æœ‰</p>
<script type="math/tex; mode=display">\varphi(n)=n \times\prod_{i=1}^{s} \dfrac{p_i-1}{p_i}</script><p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªå…¬å¼æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p>
<h3 id="2-6-3-å¼•ç†"><a href="#2-6-3-å¼•ç†" class="headerlink" title="2.6.3 å¼•ç†"></a>2.6.3 å¼•ç†</h3><p>è®¾ $p$ ä¸ºç´ æ•°é›†ï¼Œåˆ™ $\varphi(p^k)=p^k-p^{k-1}$ã€‚</p>
<p>è¿™å¾ˆå¥½è¯æ˜ï¼Œ$p^k$ ä¸ªæ•°ä¸­ï¼Œåªæœ‰ $p^{k-1}$ ä¸ªæ˜¯ $p$ çš„å€æ•°ï¼Œå…¶ä»–æ•°éƒ½ä¸å« $p$ è¿™ä¸ªå› å­ï¼Œæ•… $\varphi(p^k)=p^k-p^{k-1}$ã€‚</p>
<p>äºæ˜¯ï¼Œæ ¹æ®æ¬§æ‹‰å‡½æ•°çš„ç§¯æ€§å’Œå”¯ä¸€åˆ†è§£å®šç†å¯çŸ¥</p>
<script type="math/tex; mode=display">
\begin{aligned}
\varphi(n)&=\prod^s_{i=1}\varphi(p_i^{k_i})\\
&=\prod^s_{i=1} p_i^{k_i}-p_i^{k_i-1}\\
&=\prod^s_{i=1} p_i^{k_i-1}\cdot (p_i-1)\\
&=\prod^s_{i=1} p_i^{k_i}\cdot \dfrac{p_i-1}{p_i}\\
&=n \times \prod^s_{i=1} \dfrac{p_i-1}{p_i}
\end{aligned}</script><h3 id="2-6-4-æ±‚ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°"><a href="#2-6-4-æ±‚ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°" class="headerlink" title="2.6.4 æ±‚ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°"></a>2.6.4 æ±‚ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°</h3><h4 id="2-6-4-1-æœ´ç´ æ±‚æ³•-Theta-sqrt-n"><a href="#2-6-4-1-æœ´ç´ æ±‚æ³•-Theta-sqrt-n" class="headerlink" title="2.6.4.1 æœ´ç´ æ±‚æ³• $\Theta(\sqrt n)$"></a>2.6.4.1 æœ´ç´ æ±‚æ³• $\Theta(\sqrt n)$</h4><h4 id="2-6-4-2-Pollard-Rho-Theta-n-frac-1-4"><a href="#2-6-4-2-Pollard-Rho-Theta-n-frac-1-4" class="headerlink" title="2.6.4.2 Pollard-Rho $\Theta(n ^{\frac{1}{4}})$"></a>2.6.4.2 Pollard-Rho $\Theta(n ^{\frac{1}{4}})$</h4><h3 id="2-6-5-ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°-Theta-n"><a href="#2-6-5-ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°-Theta-n" class="headerlink" title="2.6.5 ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° $\Theta(n)$"></a>2.6.5 ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° $\Theta(n)$</h3><p>æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæ¬§æ‹‰ç­›æ¯æ¬¡éƒ½ä¼šä»¥å®ƒæœ€å°çš„ç´ å› å­ç­›åˆ°è¿™ä¸ªæ•°ã€‚è®¾ $n=pq$ï¼Œå…¶ä¸­ $p$ ä¸ºå®ƒæœ€å°çš„ç´ å› å­ï¼Œåˆ†ç±»è®¨è®ºï¼š</p>
<ol>
<li>$q \bmod{p}=0$ï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œ$q$ ä¸­æœ‰ $n$ å…¨éƒ¨çš„ç´ å› å­ï¼Œäºæ˜¯ </li>
</ol>
<script type="math/tex; mode=display">
\begin{aligned}
\varphi(n)&=n \times\prod_{i=1}^{s} \dfrac{p_i-1}{p_i}\\
&=p\times q \times\prod_{i=1}^{s} \dfrac{p_i-1}{p_i}\\
&= p \times \varphi(q)
\end{aligned}</script><ol>
<li>$q\bmod{p} \neq 0$ï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´ $p,q$ äº’è´¨ï¼Œäºæ˜¯æ ¹æ®ç§¯æ€§ï¼Œæœ‰</li>
</ol>
<script type="math/tex; mode=display">\varphi(n)=\varphi(p)\times \varphi(q)</script><p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1000000</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> pri[MAXN],phi[MAXN],cnt;</span><br><span class="line"><span class="type">bool</span> is_prime[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_euler</span><span class="params">(<span class="type">const</span> <span class="type">int</span> N)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++) is_prime[i]=<span class="number">1</span>;</span><br><span class="line">	is_prime[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">	phi[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	cnt=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(is_prime[i])&#123;</span><br><span class="line">			pri[++cnt]=i;</span><br><span class="line">			phi[i]=i<span class="number">-1</span>; <span class="comment">//iä¸ºç´ æ•°ï¼Œphi[i]=i-1</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=cnt;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(i*pri[j]&gt;N) <span class="keyword">break</span>;</span><br><span class="line">			is_prime[i*pri[j]]=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span>(i%pri[j]) <span class="comment">// æ³¨æ„åˆ†è¾¨ phi å’Œ pri</span></span><br><span class="line">				phi[i*pri[j]]=phi[i]*phi[pri[j]]; <span class="comment">// æƒ…å†µ1</span></span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				phi[i*pri[j]]=phi[i]*pri[j]; <span class="comment">// æƒ…å†µ2</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,T;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">get_euler</span>(MAXN<span class="number">-5</span>);</span><br><span class="line">	cin&gt;&gt;T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		cin&gt;&gt;n;</span><br><span class="line">		cout&lt;&lt;phi[n]&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-æœ€å¤§å…¬çº¦æ•°"><a href="#3-æœ€å¤§å…¬çº¦æ•°" class="headerlink" title="3 æœ€å¤§å…¬çº¦æ•°"></a>3 æœ€å¤§å…¬çº¦æ•°</h2><h3 id="3-1-æœ€å¤§å…¬çº¦æ•°-gcd-a-b"><a href="#3-1-æœ€å¤§å…¬çº¦æ•°-gcd-a-b" class="headerlink" title="3.1 æœ€å¤§å…¬çº¦æ•° $\gcd(a,b)$"></a>3.1 æœ€å¤§å…¬çº¦æ•° $\gcd(a,b)$</h3><p>å®šä¹‰æ­£æ•´æ•° $a,b$ çš„æœ€å¤§å…¬çº¦æ•°ä¸ºä»–ä»¬å…±åŒçš„çº¦æ•°ä¸­æœ€å¤§çš„ä¸€ä¸ªï¼ˆ<em>Greatest Common Divisor</em>ï¼‰ï¼Œç®€å†™ä¸º $\gcd$ã€‚</p>
<p>å¯¹äºå¦‚ä½•å¿«é€Ÿåœ°æ±‚å‡º $\gcd(a,b)$ï¼Œæœ‰<strong>æ¬§å‡ é‡Œå¾—ç®—æ³•</strong>ã€‚</p>
<ul>
<li>æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼šå¯¹äºæ­£æ•´æ•° $a,b$ï¼Œæœ‰ $\gcd(a,b)=\gcd(b,a \bmod{b})$ã€‚</li>
</ul>
<p>ä¸‹é¢ç»™å‡ºè¿™ä¸ªç®—æ³•çš„è¯æ˜è¿‡ç¨‹ï¼ˆä¸ªäººè§‰å¾— OI-Wiki ä¸Šçš„æœ‰äº›ä¸ä¸¥è°¨ï¼‰ï¼š</p>
<h4 id="Proof"><a href="#Proof" class="headerlink" title="Proof"></a>Proof</h4><ul>
<li><p><strong>ç­‰å¼ $1$</strong>ï¼šå¦‚æœ $a \mid b \land b \mid a$ï¼Œæœ‰ $a = \pm b$ã€‚ï¼ˆ<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/501865/number-theory-in-oi#:~:text=1.1"><strong>1.1 æ•´é™¤</strong></a>ï¼‰</p>
</li>
<li><p><strong>ç­‰å¼ $2$</strong>ï¼š$a\mid b\land a\mid c\iff\forall x,y\in\mathbf{Z}, a\mid(xb+yc)$ã€‚ï¼ˆ<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/501865/number-theory-in-oi#:~:text=1.1"><strong>1.1 æ•´é™¤</strong></a>ï¼‰</p>
</li>
<li><p><strong>ç­‰å¼ $3$</strong>ï¼š$a \in \mathbf{Z}, n \in \mathbf{N}^{+},a \bmod n = a-n\left\lfloor\dfrac{a}{n}\right\rfloor$ã€‚ï¼ˆ<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/501865/number-theory-in-oi#:~:text=1.2"><strong>1.2 å¸¦ä½™é™¤æ³•</strong></a>ï¼‰</p>
</li>
<li><p><strong>æ¨è®º $1$</strong>ï¼š$d \mid a \land d \mid b \implies d \mid \gcd(a,b)$ã€‚</p>
<ul>
<li>å¾ˆæ˜¾ç„¶ $a,b$ çš„å…¬çº¦æ•°é‡Œæœ‰ $a,b$ å…±åŒçš„å› å­ï¼Œç„¶å $\gcd(a,b)$ æ˜¾ç„¶ä¹Ÿæœ‰ä»–ä»¬å…±åŒçš„å› å­ï¼Œæ ¹æ® <strong>å”¯ä¸€åˆ†è§£å®šç†</strong>ï¼Œ$\gcd(a,b)$ è¦ä¹ˆæ¯” $d$ å«æœ‰çš„å› å­æ•°å¤šï¼Œè¦ä¹ˆä»–ä»¬å…±åŒå«æœ‰çš„å› å­ $\gcd(a,b)$ çš„å¹‚æ¬¡ä¸€å®šå¤§äº $d$ï¼ˆä¸ç„¶ä¸æ˜¯<strong>æœ€å¤§</strong>å…¬çº¦æ•°ï¼‰ï¼Œäºæ˜¯ $d \mid \gcd(a,b)$ã€‚</li>
</ul>
</li>
</ul>
<hr>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ¨å‡º $\gcd(a,b) \mid \gcd(b,a \bmod{b})$ï¼š</p>
<p>è®¾ $d=\gcd(a,b),r=a \bmod{b}$ã€‚</p>
<p>ç”± <strong>ç­‰å¼ $3$</strong> å¾— $r=a-b\left\lfloor\dfrac{a}{b}\right\rfloor$ã€‚</p>
<p>äºæ˜¯æ ¹æ® <strong>ç­‰å¼ $2$</strong> ï¼Œç”± $d \mid a \land d \mid b$ ä¸” $r=a-b\left\lfloor\dfrac{a}{b}\right\rfloor$ï¼Œæ¨å‡º $d \mid r$ï¼Œå³ $d \mid a \bmod{b}$ã€‚</p>
<p>ç”± <strong>æ¨è®º $1$</strong> ï¼Œå› ä¸º $d \mid b \land d \mid a \bmod{b}$ï¼Œäºæ˜¯ $d \mid \gcd(a,a \bmod{b})$ã€‚</p>
<p>å³ $\gcd(a,b) \mid \gcd(b,a \bmod{b})$ã€‚</p>
<hr>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ¨å‡º $\gcd(b,a \bmod{b}) \mid \gcd(a,b)$ï¼š</p>
<p>è®¾ $c=\gcd(b,a \bmod{b})$ï¼Œåˆ™æœ‰ $c\mid b \land c \mid(a \bmod{b})$ã€‚</p>
<p>ç”±å¸¦ä½™é™¤æ³•ï¼Œ$a=bq+r$ï¼Œå…¶ä¸­ $q=\left\lfloor\dfrac{a}{b}\right\rfloor,r=a \bmod b$ã€‚</p>
<p>äºæ˜¯æ ¹æ® <strong>ç­‰å¼ $2$</strong> ï¼Œç”± $c \mid b \land c \mid (a\bmod{b})$ ä¸” $a=b \left\lfloor\dfrac{a}{b}\right\rfloor+a \bmod{b}$ï¼Œå¾—å‡º $c \mid a$ã€‚</p>
<p>äºæ˜¯æœ‰ $c \mid a \land c \mid b$ åˆå› ä¸º <strong>æ¨è®º $1$</strong> ï¼Œå¾—å‡º $c \mid \gcd(a,b)$ã€‚</p>
<p>å³ $\gcd(b,a \bmod{b}) \mid \gcd(a,b)$ã€‚</p>
<hr>
<p>äºæ˜¯æ ¹æ® <strong>ç­‰å¼ $1$</strong> ï¼Œ$\gcd(b,a \bmod{b}) \mid \gcd(a,b) \land \gcd(a,b) \mid \gcd(b,a \bmod{b}) \implies \gcd(a,b)=\gcd(b,a\bmod{b}) \square$ã€‚</p>
<p>è‡³æ­¤ï¼Œ<strong>æ¬§å‡ é‡Œå¾—å®šç†ï¼ˆæˆ–è¾—è½¬ç›¸é™¤æ³•ã€$\gcd$ é€’å½’å®šç†ï¼‰</strong> è¯æ˜å®Œæ¯•ã€‚</p>
<p>å› ä¸ºæ¯æ¬¡ $a \bmod{b}$ çš„å€¼è‡³å¤šå˜ä¸º $a$ çš„ä¸€åŠï¼Œæ‰€ä»¥è¯¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º $\Theta(\log n)$ã€‚</p>
<p>å¸¸è§çš„å‡ ç§å†™æ³•ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»¥ä¸‹é»˜è®¤ typedef long long ll </span></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123; <span class="comment">// éé€’å½’ç‰ˆ</span></span><br><span class="line">    <span class="type">int</span> tmp;</span><br><span class="line">    <span class="keyword">while</span>(b!=<span class="number">0</span>)&#123;</span><br><span class="line">        tmp=b;</span><br><span class="line">        b=a%b;</span><br><span class="line">        a=tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123; <span class="comment">// é€’å½’ç‰ˆ</span></span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">gcd</span>(b,a%b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123; <span class="comment">// é€’å½’ç‰ˆç®€åŒ–</span></span><br><span class="line">	<span class="keyword">return</span> b==<span class="number">0</span>?a:<span class="built_in">gcd</span>(b,a%b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123; <span class="comment">// ä½è¿ç®—ç‰ˆ</span></span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        a%=b;</span><br><span class="line">        b^=a;</span><br><span class="line">        a^=b;</span><br><span class="line">        b^=a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123; <span class="comment">// ä½è¿ç®—ç®€åŒ–</span></span><br><span class="line">	<span class="keyword">while</span>(b^=a^=b^=a%=b);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-2-æœ€å°å…¬å€æ•°-operatorname-lcm-a-b"><a href="#3-2-æœ€å°å…¬å€æ•°-operatorname-lcm-a-b" class="headerlink" title="3.2 æœ€å°å…¬å€æ•° $\operatorname{lcm}(a,b)$"></a>3.2 æœ€å°å…¬å€æ•° $\operatorname{lcm}(a,b)$</h2><p>å®šä¹‰æ­£æ•´æ•° $a,b$ çš„æœ€å°å…¬å€æ•°ä¸ºä»–ä»¬å…±åŒçš„å€æ•°ä¸­æœ€å°çš„ä¸€ä¸ªï¼ˆ<em>Least Common Multiple</em>ï¼‰ï¼Œç®€å†™ä¸º $\operatorname{lcm}$ã€‚</p>
<p>æˆ‘ä»¬æ¥ä¸‹æ¥æ¥æ¨ä¸€æ¨ $\operatorname{lcm}$ è¦å¦‚ä½•å¿«é€Ÿåœ°æ±‚ã€‚</p>
<p>ç”± <strong>å”¯ä¸€åˆ†è§£å®šç†</strong>ï¼Œå¯å¾—</p>
<script type="math/tex; mode=display">a=p_1^{ka_1}p_2^{ka_2}\cdots p_s^{ka_s},b=p_1^{kb_1}p_2^{kb_2}\cdots p_s^{kb_s}</script><p>å› ä¸º $\gcd$ ä¸ºäºŒè€…çš„æœ€å¤§å…¬å› æ•°ï¼Œæ‰€ä»¥æœ‰</p>
<script type="math/tex; mode=display">\gcd(a,b)=p_1^{\min(ka_1,kb_1)}p_2^{\min(ka_2,kb_2)}\cdots p_s^{\min(ka_s,kb_s)}</script><p>åŒç†ï¼Œ$\operatorname{lcm}$ å³ä¸º</p>
<script type="math/tex; mode=display">\operatorname{lcm}(a,b)=p_1^{\max(ka_1,kb_1)}p_2^{\max(ka_2,kb_2)}\cdots p_s^{\max(ka_s,kb_s)}</script><p>å› ä¸º $ka_1+kb_1=\min(ka_1+kb_1)+\max(ka_2+kb_2)$ï¼Œæ‰€ä»¥ $\gcd(a,b) \times \operatorname{lcm}(a,b)=a \times b$ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æ±‚å‡ºäº†ä¸¤ä¸ªæ•°çš„ $\gcd$ï¼Œä¸¤ä¸ªæ•°çš„ $\operatorname{lcm}$ å°±èƒ½ $\Theta(1)$ æ±‚å‡ºæ¥ï¼Œå®¹æ˜“çœ‹å‡ºï¼Œæ±‚è§£ $\operatorname{lcm}$ çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿä¸º $\Theta(\log n)$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">lcm</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a/<span class="built_in">gcd</span>(a,b)*b; <span class="comment">// é˜²æ­¢ a*b çˆ† llï¼Œæ‰€ä»¥å…ˆ /gcd å† *b</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-3-æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•-text-exgcd"><a href="#3-3-æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•-text-exgcd" class="headerlink" title="3.3 æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• $\text{exgcd}$"></a>3.3 æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• $\text{exgcd}$</h2><p>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆ<em>Extended Euclidean algorithm</em>ï¼‰ï¼Œç®€å†™ä¸º $\text{exgcd}$ï¼Œæ˜¯ç”¨æ¥æ±‚è§£å½¢å¦‚ $ax+by=\gcd(a,b)$ çš„ä¸€ç»„å¯è¡Œè§£ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªç®—æ³•ï¼š</p>
<p>é¦–å…ˆï¼Œå½“ $b=0$ æ—¶ï¼Œæ˜¾ç„¶æœ‰ $\gcd(a,0)=a$ï¼Œæ­¤æ—¶ $\begin{cases}x=1\\y=0\end{cases}$ æ˜¯æ–¹ç¨‹çš„ä¸€ç»„å¯è¡Œè§£ã€‚</p>
<p>è®¾ $ax_1+by_1=\gcd(a,b)$ï¼Œ$bx_2+(a \bmod b)y_2=\gcd(b,a \bmod{b})$ã€‚</p>
<p>äºæ˜¯æ ¹æ® <strong>æ¬§å‡ é‡Œå¾—å®šç†</strong>ï¼Œæ˜¾ç„¶æœ‰ $ax_1+by_1=bx_2+(a \bmod{b})y_2$</p>
<p>äºæ˜¯</p>
<script type="math/tex; mode=display">
\begin{aligned}
ax_1+by_1&=bx_2+(a\bmod b)y_2\\
ax_1+by_1&=bx_2+\left( a-b \left\lfloor \dfrac{a}{b}\right\rfloor\right) y_2\\
ax_1+by_1&=bx_2+ay_2-b\left\lfloor \dfrac{a}{b}\right\rfloor y_2\\
ax_1+by_1&=ay_2+b\left(x_2-\left\lfloor \dfrac{a}{b}\right\rfloor y_2\right)\\
x_1=y_2&,y_1=x_2-\left\lfloor \dfrac{a}{b}\right\rfloor y_2
\end{aligned}</script><p>ç”¨ $\gcd$ é€’å½’æ±‚è§£å³å¯ã€‚å½“ $b=0$ æ—¶ï¼Œå¸¦å…¥ä¸Šæ–‡çš„ç‰¹è§£è¿”å›ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">		x=<span class="number">1</span>; y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line">	ll d=<span class="built_in">exgcd</span>(b,a%b,x,y);</span><br><span class="line">	ll t=x;</span><br><span class="line">	x=y;</span><br><span class="line">	y=t-(a/b)*y;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-1-ç”¨-text-exgcd-æ±‚è§£çš„ä¸€ä¸ªé—®é¢˜"><a href="#3-3-1-ç”¨-text-exgcd-æ±‚è§£çš„ä¸€ä¸ªé—®é¢˜" class="headerlink" title="3.3.1 ç”¨ $\text{exgcd}$ æ±‚è§£çš„ä¸€ä¸ªé—®é¢˜"></a>3.3.1 ç”¨ $\text{exgcd}$ æ±‚è§£çš„ä¸€ä¸ªé—®é¢˜</h3><p>é¢˜æ„ï¼šç»™å®š $a,b$ï¼Œæ±‚å‡º $ax \equiv 1 \pmod{b}$ ä¸­ $x$ çš„æœ€å°æ­£æ•´æ•°è§£ï¼Œä¿è¯æœ‰è§£ã€‚</p>
<p>é—®é¢˜è½¬åŒ–ï¼š$ax \equiv 1 \pmod{b} \implies ax+by=1$ï¼Œå…¶ä¸­ $y$ æ˜¯æˆ‘ä»¬å¼•è¿›çš„ä¸€ä¸ª<strong>è´Ÿæ•´æ•°</strong>ã€‚</p>
<p>æ˜æ˜¾åœ°ï¼Œ$\text{exgcd}$ å¯ä»¥ç”¨æ¥æ±‚è§£å½¢å¦‚ $ax+by=\gcd(a,b)$ çš„è§£ï¼Œç°åœ¨çš„é—®é¢˜æ˜¯å¦‚ä½•æŠŠ $1$ å’Œ $\gcd(a,b)$ è”ç³»èµ·æ¥ã€‚</p>
<p><strong>å¼•ç†</strong>ï¼š$ax+by=m$ æœ‰æ•´æ•°è§£çš„å¿…è¦æ¡ä»¶æ˜¯ $\gcd(a,b)\mid m$ã€‚</p>
<p><strong>Proof</strong>ï¼šå› ä¸º $\gcd(a,b) \mid a \land \gcd(a,b) \mid b$ï¼Œæ‰€ä»¥ $\gcd(a,b) \mid (ax+by)$ï¼Œå³ $\gcd(a,b) \mid m$ã€‚</p>
<p>äºæ˜¯å†è”ç³»åˆ°é¢˜ç›®ä¸Šï¼Œå°±æœ‰ $\gcd(a,b)\mid 1$ï¼Œå› ä¸º $\gcd(a,b)$ æ˜¾ç„¶æ˜¯ä¸ªæ­£æ•´æ•°ï¼Œæ‰€ä»¥ $\gcd(a,b)$ åªèƒ½ç­‰äº $1$ äº†ã€‚</p>
<p><strong>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œ$a,b$ äº’è´¨</strong>ï¼Œäºæ˜¯ $\gcd(a,b)=1$ï¼Œæ­£å¥½ç¬¦åˆ $\text{exgcd}$ çš„åŸå§‹å½¢å¼ï¼Œæ‰€ä»¥ $\text{exgcd}$ å°±å¯ä»¥åœ¨ $\Theta(\log n)$ çš„æ—¶é—´æ¥æ±‚è§£ã€‚</p>
<p><strong>æœ€å°æ­£æ•´æ•°è§£</strong></p>
<p>å› ä¸º $ax+by=1$ï¼Œæ‰€ä»¥ $ax+by+kab-kab=1$ï¼Œæ‰€ä»¥ $a(x\pm kb)+b(y \mp ka)=1$ã€‚</p>
<p>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ $x&gt;0$ï¼Œé‚£ä¹ˆå°±æŠŠ $x$ ä¸€ç›´å‡ $b$ï¼Œç›´åˆ°ä¸èƒ½å‡ä¸ºæ­¢ï¼Œåä¹‹äº¦ç„¶ã€‚</p>
<p>è¿™åœ¨ C++ çš„è¿ç®—ä¸­ï¼Œç”¨ <code>x = (x % b + b) % b</code> å³å¯è§£å†³ï¼Œåé¢çš„ <code>+ b) % b</code> æ˜¯ä¸ºäº†è®© $x$ ä»è´Ÿæ•°å˜ä¸ºæ­£æ•°ã€‚</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"></span><br><span class="line">ll a,b,x,y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">		x=<span class="number">1</span>; y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">exgcd</span>(b,a%b,x,y);</span><br><span class="line">	ll tmp=x;</span><br><span class="line">	x=y;</span><br><span class="line">	y=tmp-(a/b)*y;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">	<span class="built_in">exgcd</span>(a,b,x,y);</span><br><span class="line">	x=(x%b+b)%b;</span><br><span class="line">	cout&lt;&lt;x&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="3-3-2-æœ‰ç†æ•°å–ä½™ï¼šç”¨-text-exgcd-æ±‚è§£çš„å¦ä¸€ä¸ªé—®é¢˜"><a href="#3-3-2-æœ‰ç†æ•°å–ä½™ï¼šç”¨-text-exgcd-æ±‚è§£çš„å¦ä¸€ä¸ªé—®é¢˜" class="headerlink" title="3.3.2 æœ‰ç†æ•°å–ä½™ï¼šç”¨ $\text{exgcd}$ æ±‚è§£çš„å¦ä¸€ä¸ªé—®é¢˜"></a>3.3.2 æœ‰ç†æ•°å–ä½™ï¼šç”¨ $\text{exgcd}$ æ±‚è§£çš„å¦ä¸€ä¸ªé—®é¢˜</h3><ul>
<li>ç»™å®š $c=\dfrac{a}{b}$ï¼Œæ±‚ $c \bmod p$ çš„å€¼ã€‚</li>
</ul>
<p>è¿™ä¸ªå€¼è¢«å®šä¹‰ä¸º $bx \equiv a \pmod p$ çš„è§£ã€‚</p>
<p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ã€‚</p>
<p>å› ä¸ºåŒä½™æœ‰æ€§è´¨ï¼š å¦‚æœ $b \equiv a \pmod p$ï¼Œé‚£ä¹ˆä¸¤è¾¹ä¹˜ä¸Šä¸€ä¸ªæ•°ä¹‹åï¼Œè¿˜æ˜¯ä¸å˜ï¼š $b \times d \equiv a \times d \pmod p$ï¼Œå¸¦è¿›åŸå¼ï¼Œå°±å˜æˆäº† $bx \equiv a \pmod p$ã€‚</p>
<p>æ…¢ç€ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸Šä¸€ä¸ªé—®é¢˜ï¼Œä»–æ±‚è§£çš„æ˜¯ $bx_1 \equiv 1 \pmod{p}$ï¼Œç„¶åä¸¤è¾¹åŒä¹˜ $a$ï¼Œå˜æˆäº† $b (ax_1) \equiv a \pmod p$ã€‚</p>
<p>äºæ˜¯æœ‰ $x=ax_1$ï¼Œé—®é¢˜è§£å†³ã€‚</p>
<p>ç­‰ç­‰ï¼Œé‚£æ— è§£æƒ…å†µå‘¢ï¼Ÿæˆ‘ä»¬åˆ†æƒ…å†µè®¨è®ºä¸€ä¸‹ï¼š</p>
<ol>
<li><p>$b \bmod p = 0$ï¼Œå³ $b$ ä¸º $p$ çš„å€æ•°ï¼š</p>
<ul>
<li>$a \bmod p = 0$ï¼Œå³ $a$ ä¹Ÿä¸º $p$ çš„å€æ•°ï¼Œäºæ˜¯åŸåŒä½™å¼æœ‰æ— æ•°è§£ã€‚</li>
<li>$a \bmod p \ne 0$ï¼Œå³ $a$ ä¸ä¸º $p$ çš„å€æ•°ï¼Œäºæ˜¯åŸåŒä½™å¼æ— è§£ï¼ˆå› ä¸ºç­‰å¼å·¦è¾¹ $\mod p$ æ°¸è¿œä¸º $0$ï¼‰ã€‚</li>
</ul>
</li>
<li><p>$b \bmod p \ne 0$ï¼Œå³ $b$ ä¸ä¸º $p$ çš„å€æ•°ï¼š</p>
<ul>
<li>å³ $b,p$ äº’è´¨ï¼Œ$\gcd(b,p)=1$ï¼Œäºæ˜¯æ ¹æ® <strong>3.3.1</strong> ä¸­çš„ä¸€ä¸ªç»“è®ºï¼ŒåŸæ–¹ç¨‹å¿…å®šæœ‰è§£ã€‚</li>
</ul>
</li>
</ol>
<p>æ€»ç»“ï¼šå¦‚æœ $b \bmod p=0$ï¼Œåˆ™åŸæ–¹ç¨‹æ— è§£ã€‚</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> p = <span class="number">19260817</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">char</span> ch=<span class="built_in">getchar</span>(); <span class="function">ll <span class="title">x</span><span class="params">(<span class="number">0</span>)</span>,<span class="title">f</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(; !<span class="built_in">isdigit</span>(ch); ch=<span class="built_in">getchar</span>()) f|=(ch==<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">	<span class="keyword">for</span>(;  <span class="built_in">isdigit</span>(ch); ch=<span class="built_in">getchar</span>()) x=((x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>))%p;</span><br><span class="line">	<span class="keyword">return</span> f?-x:x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">		x=<span class="number">1</span>; y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line">	ll d=<span class="built_in">exgcd</span>(b,a%b,x,y);</span><br><span class="line">	ll t=x;</span><br><span class="line">	x=y;</span><br><span class="line">	y=t-(a/b)*y;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll a,b,x,y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	a=<span class="built_in">read</span>(); b=<span class="built_in">read</span>();</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Angry!&quot;</span>)&amp;<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">exgcd</span>(b,p,x,y);</span><br><span class="line">	ll ans=(a*x%p+p)%p;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-3-text-exgcd-ä¾‹é¢˜"><a href="#3-3-3-text-exgcd-ä¾‹é¢˜" class="headerlink" title="3.3.3 $\text{exgcd}$ ä¾‹é¢˜"></a>3.3.3 $\text{exgcd}$ ä¾‹é¢˜</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1082">https://www.luogu.com.cn/problem/P1082</a></li>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5656">https://www.luogu.com.cn/problem/P5656</a></li>
</ul>
<h2 id="4-æ•°è®ºåˆ†å—"><a href="#4-æ•°è®ºåˆ†å—" class="headerlink" title="4 æ•°è®ºåˆ†å—"></a>4 æ•°è®ºåˆ†å—</h2><h3 id="4-1-ç®—æ³•"><a href="#4-1-ç®—æ³•" class="headerlink" title="4.1 ç®—æ³•"></a>4.1 ç®—æ³•</h3><blockquote>
<p>ç»™å®š $n\in \mathbf N^{+}$, æ±‚ $\sum^n_{i=1} \left\lfloor\dfrac{n}{i}\right\rfloor$ çš„å€¼ã€‚</p>
</blockquote>
<p>æœ´ç´ ç®—æ³•æ˜¯ $\Theta(n)$ çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚</p>
<p>æœ‰ç»“è®ºï¼šå¯¹äº $\left\lfloor\dfrac n i\right\rfloor =\left\lfloor\dfrac n j\right\rfloor$ ä¸” $1 \le i \le j \le n$ï¼Œæœ‰ $j$ çš„æœ€å¤§å€¼ä¸º $\left\lfloor\dfrac n i\right\rfloor$ã€‚</p>
<p>è¯æ˜ï¼šè®¾ $k = \left\lfloor\dfrac n i\right\rfloor$ï¼Œæ˜¾ç„¶æœ‰ $k \le \dfrac n i$ã€‚</p>
<script type="math/tex; mode=display">\therefore \left\lfloor\dfrac n k\right\rfloor \ge \left\lfloor\frac n {\frac n i}\right\rfloor = \left\lfloor i \right\rfloor=i</script><script type="math/tex; mode=display">\therefore j=\max_{\left\lfloor\frac n i\right\rfloor =\left\lfloor\frac n j\right\rfloor} i=\left\lfloor\dfrac n k\right\rfloor=\left\lfloor\frac n {\frac n i}\right\rfloor \qquad \square</script><p>å®¹æ˜“è¯å¾—ï¼Œç¬¦åˆè¦æ±‚çš„åŒºé—´çº¦æœ‰ $\sqrt n$ ç§ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ $\Theta(\sqrt n)$ ã€‚</p>
<p><strong>Sample Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">H</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	ll res = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> l = <span class="number">1</span>, r;</span><br><span class="line">	<span class="keyword">while</span>(l &lt;= n)&#123;</span><br><span class="line">		r = n / (n / l);</span><br><span class="line">		res += <span class="number">1ll</span> * (r - l + <span class="number">1</span>) * (n / l);</span><br><span class="line">		l = r + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-2-ä¾‹é¢˜"><a href="#4-2-ä¾‹é¢˜" class="headerlink" title="4.2 ä¾‹é¢˜"></a>4.2 ä¾‹é¢˜</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/UVA11526">https://www.luogu.com.cn/problem/UVA11526</a></li>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2261">https://www.luogu.com.cn/problem/P2261</a></li>
</ul>
<h3 id="4-3-ç”¨æ•°è®ºåˆ†å—è§£å†³çš„ä¸€ä¸ªé—®é¢˜"><a href="#4-3-ç”¨æ•°è®ºåˆ†å—è§£å†³çš„ä¸€ä¸ªé—®é¢˜" class="headerlink" title="4.3 ç”¨æ•°è®ºåˆ†å—è§£å†³çš„ä¸€ä¸ªé—®é¢˜"></a>4.3 ç”¨æ•°è®ºåˆ†å—è§£å†³çš„ä¸€ä¸ªé—®é¢˜</h3><p>ä»¥ <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2261">P2261 [CQOI2007]ä½™æ•°æ±‚å’Œ</a> ä¸ºä¾‹ã€‚</p>
<blockquote>
<p>ç»™å‡º $n,k$ï¼Œæ±‚ $\sum^n_{i=1} k \bmod i$ã€‚</p>
</blockquote>
<p>é¢˜ç›®è½¬åŒ–ï¼šç”±å¸¦ä½™é™¤æ³•ä¸€ç« ï¼Œæˆ‘ä»¬çŸ¥é“ $k \bmod i = k - i \times \left \lfloor \dfrac k i \right \rfloor$ã€‚</p>
<p>äºæ˜¯é—®é¢˜å°±å˜æˆäº† $\sum^n_{i=1} k - i \times \left \lfloor \dfrac k i \right \rfloor$ã€‚</p>
<script type="math/tex; mode=display">
\begin{aligned}
G(n,k)&=\sum^n_{i=1} k - i \times \left \lfloor \dfrac k i \right \rfloor\\
&=n\times k-\sum^n_{i=1}  i \times \left \lfloor \dfrac k i \right \rfloor
\end{aligned}</script><p>å…¶ä¸­ $\sum^n_{i=1}  i \times \left \lfloor \dfrac k i \right \rfloor$ éƒ¨åˆ†å¯ä»¥æ•°è®ºåˆ†å—ã€‚å› ä¸º $\left \lfloor \dfrac k i \right \rfloor$ ç›¸ç­‰ï¼Œç”±ä¹˜æ³•åˆ†é…å¾‹å¯å¾— $\sum^r_{l=1}  l \times \left \lfloor \dfrac k l \right \rfloor=\left \lfloor \dfrac k l \right \rfloor \times \sum^r_{l=1}  l$ã€‚åé¢çš„éƒ¨åˆ†å¯ä»¥æ•°è®ºåˆ†å—é¡ºå¸¦è§£å†³æ‰ã€‚äºæ˜¯å°±åšå®Œäº†ã€‚</p>
<p>æ³¨æ„è¿™é¢˜å’Œä¸Šé¢é‚£é¢˜ä¸åŒã€‚è¿™é¢˜ $n,k$ æ˜¯åˆ†å¼€çš„ï¼Œæ‰€ä»¥å½“ $\left \lfloor \dfrac k l\right \rfloor=0$ æ—¶è¦ç‰¹åˆ¤ï¼Œä¸ç„¶ä¼š REã€‚</p>
<p>ä»¥åŠ $r$ è¦å’Œ $n$ å– $\min$ã€‚</p>
<p>å¤æ‚åº¦ï¼š$\Theta(\sqrt n)$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">H</span><span class="params">(ll n, ll k)</span></span>&#123;</span><br><span class="line">	ll ans = k * n;</span><br><span class="line">	<span class="type">int</span> l = <span class="number">1</span>, r;</span><br><span class="line">	<span class="keyword">while</span>(l &lt;= n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(k / l != <span class="number">0</span>) r = k / (k / l);</span><br><span class="line">		<span class="keyword">else</span> r = n;</span><br><span class="line">		<span class="built_in">chkmin</span>(r, n);</span><br><span class="line">		ans -= <span class="number">1ll</span> * (l + r) * (r - l + <span class="number">1</span>) / <span class="number">2</span> * (k / l);</span><br><span class="line">		l = r + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="- Reference"></a>- Reference</h1><ul>
<li><p><a target="_blank" rel="noopener" href="https://oi-wiki.org/math/">https://oi-wiki.org/math/</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/87611586">https://zhuanlan.zhihu.com/p/87611586</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zwfymqz/p/8150969.html">https://www.cnblogs.com/zwfymqz/p/8150969.html</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/346479426">https://zhuanlan.zhihu.com/p/346479426</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/cicos/solution-p1082">https://www.luogu.com.cn/blog/cicos/solution-p1082</a></p>
</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Math/" rel="tag"># Math</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/03/02/link-cut-tree-data-structure/" rel="prev" title="ã€å­¦ä¹ ç¬”è®°ã€‘åŠ¨æ€æ ‘Link Cut Tree">
      <i class="fa fa-chevron-left"></i> ã€å­¦ä¹ ç¬”è®°ã€‘åŠ¨æ€æ ‘Link Cut Tree
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/03/02/csp-j-2020-2021-eternal-core/" rel="next" title="CSP-J 2020 åŠ 2021 æ¸¸è®° / Eternal Core.">
      CSP-J 2020 åŠ 2021 æ¸¸è®° / Eternal Core. <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%E3%80%91OI-%E4%B8%AD%E7%9A%84%E6%95%B0%E8%AE%BA"><span class="nav-number">1.</span> <span class="nav-text">ã€å­¦ä¹ ç¬”è®° &#x2F; é•¿æœŸæ›´æ–°ã€‘OI ä¸­çš„æ•°è®º</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95"><span class="nav-number">2.</span> <span class="nav-text">ç›®å½•</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Preface"><span class="nav-number">3.</span> <span class="nav-text">- Preface</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0-1-%E5%89%8D%E8%A8%80"><span class="nav-number">3.1.</span> <span class="nav-text">0.1 å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0-2-%E5%B8%B8%E7%94%A8%E7%AC%A6%E5%8F%B7"><span class="nav-number">3.2.</span> <span class="nav-text">0.2 å¸¸ç”¨ç¬¦å·</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0-3-%E5%BF%AB%E9%80%9F%E5%B9%82-Theta-log-n"><span class="nav-number">3.3.</span> <span class="nav-text">0.3 å¿«é€Ÿå¹‚ $\Theta(\log n)$</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E8%AE%BA"><span class="nav-number">4.</span> <span class="nav-text">- æ•°è®º</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%95%B0%E8%AE%BA%E5%9F%BA%E7%A1%80"><span class="nav-number">4.1.</span> <span class="nav-text">1 æ•°è®ºåŸºç¡€</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%95%B4%E9%99%A4"><span class="nav-number">4.1.1.</span> <span class="nav-text">1.1 æ•´é™¤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E5%B8%A6%E4%BD%99%E9%99%A4%E6%B3%95"><span class="nav-number">4.1.2.</span> <span class="nav-text">1.2 å¸¦ä½™é™¤æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E5%90%8C%E4%BD%99"><span class="nav-number">4.1.3.</span> <span class="nav-text">1.3 åŒä½™</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0"><span class="nav-number">4.1.4.</span> <span class="nav-text">1.4 æ•°è®ºå‡½æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-1-%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0"><span class="nav-number">4.1.5.</span> <span class="nav-text">1.4.1 ç§¯æ€§å‡½æ•°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E7%B4%A0%E6%95%B0"><span class="nav-number">4.2.</span> <span class="nav-text">2 ç´ æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E5%94%AF%E4%B8%80%E5%88%86%E8%A7%A3%E5%AE%9A%E7%90%86"><span class="nav-number">4.2.1.</span> <span class="nav-text">2.1 å”¯ä¸€åˆ†è§£å®šç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E5%88%A4%E5%AE%9A%E7%B4%A0%E6%95%B0-Theta-sqrt-n"><span class="nav-number">4.2.2.</span> <span class="nav-text">2.2 åˆ¤å®šç´ æ•° $\Theta(\sqrt{n})$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Miller-Rabin-%E5%88%A4%E5%AE%9A%E7%B4%A0%E6%95%B0-Theta-k-log-3n"><span class="nav-number">4.2.3.</span> <span class="nav-text">2.3 Miller-Rabin åˆ¤å®šç´ æ•° $\Theta(k \log^3n)$</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86%EF%BC%88Fermat%E2%80%99s-Little-Theorem%EF%BC%89"><span class="nav-number">4.2.3.1.</span> <span class="nav-text">2.3.1 è´¹é©¬å°å®šç†ï¼ˆFermatâ€™s Little Theoremï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-%E4%BA%8C%E6%AC%A1%E6%8E%A2%E6%B5%8B%E5%AE%9A%E7%90%86"><span class="nav-number">4.2.3.2.</span> <span class="nav-text">2.3.2 äºŒæ¬¡æ¢æµ‹å®šç†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-Miller-Rabin"><span class="nav-number">4.2.3.3.</span> <span class="nav-text">2.3.3 Miller-Rabin</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-%E7%B4%A0%E6%95%B0%E7%AD%9B"><span class="nav-number">4.3.</span> <span class="nav-text">2.4 ç´ æ•°ç­›</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-1-%E5%9F%83%E6%B0%8F%E7%AD%9B-Theta-n-log-log-n"><span class="nav-number">4.3.1.</span> <span class="nav-text">2.4.1 åŸƒæ°ç­› $\Theta(n \log \log n)$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-2-%E6%AC%A7%E6%8B%89%E7%AD%9B-%E7%BA%BF%E6%80%A7%E7%AD%9B-Theta-n"><span class="nav-number">4.3.2.</span> <span class="nav-text">2.4.2 æ¬§æ‹‰ç­› &#x2F; çº¿æ€§ç­› $\Theta(n)$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-3-%E7%AD%9B%E6%B3%95%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BC%98%E5%8C%96"><span class="nav-number">4.3.3.</span> <span class="nav-text">2.4.3 ç­›æ³•çš„ä¸€äº›ä¼˜åŒ–</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-%E5%88%86%E8%A7%A3%E8%B4%A8%E5%9B%A0%E6%95%B0"><span class="nav-number">4.4.</span> <span class="nav-text">2.5 åˆ†è§£è´¨å› æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-1-%E6%9C%B4%E7%B4%A0%E7%AE%97%E6%B3%95-Theta-sqrt-n"><span class="nav-number">4.4.1.</span> <span class="nav-text">2.5.1 æœ´ç´ ç®—æ³• $\Theta(\sqrt{n})$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-2-%E7%B4%A0%E6%95%B0%E7%AD%9B%E4%BC%98%E5%8C%96-Theta-sqrt-frac-n-ln-n"><span class="nav-number">4.4.2.</span> <span class="nav-text">2.5.2 ç´ æ•°ç­›ä¼˜åŒ– $\Theta(\sqrt{\frac{n}{\ln n}})$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-3-Pollard-Rho-Theta-n-frac-1-4"><span class="nav-number">4.4.3.</span> <span class="nav-text">2.5.3 Pollard-Rho $\Theta(n^{\frac{1}{4}})$</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6-%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0-varphi-n"><span class="nav-number">4.5.</span> <span class="nav-text">2.6 æ¬§æ‹‰å‡½æ•° $\varphi(n)$</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-1-%E6%80%A7%E8%B4%A8"><span class="nav-number">4.5.1.</span> <span class="nav-text">2.6.1 æ€§è´¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-2-%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0%EF%BC%88Euler%E2%80%99s-totient-function%EF%BC%89"><span class="nav-number">4.5.2.</span> <span class="nav-text">2.6.2 æ¬§æ‹‰å‡½æ•°ï¼ˆEulerâ€™s totient functionï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-3-%E5%BC%95%E7%90%86"><span class="nav-number">4.5.3.</span> <span class="nav-text">2.6.3 å¼•ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-4-%E6%B1%82%E4%B8%80%E4%B8%AA%E6%95%B0%E7%9A%84%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="nav-number">4.5.4.</span> <span class="nav-text">2.6.4 æ±‚ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-4-1-%E6%9C%B4%E7%B4%A0%E6%B1%82%E6%B3%95-Theta-sqrt-n"><span class="nav-number">4.5.4.1.</span> <span class="nav-text">2.6.4.1 æœ´ç´ æ±‚æ³• $\Theta(\sqrt n)$</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-4-2-Pollard-Rho-Theta-n-frac-1-4"><span class="nav-number">4.5.4.2.</span> <span class="nav-text">2.6.4.2 Pollard-Rho $\Theta(n ^{\frac{1}{4}})$</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-5-%E7%AD%9B%E6%B3%95%E6%B1%82%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0-Theta-n"><span class="nav-number">4.5.5.</span> <span class="nav-text">2.6.5 ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° $\Theta(n)$</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0"><span class="nav-number">4.6.</span> <span class="nav-text">3 æœ€å¤§å…¬çº¦æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0-gcd-a-b"><span class="nav-number">4.6.1.</span> <span class="nav-text">3.1 æœ€å¤§å…¬çº¦æ•° $\gcd(a,b)$</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Proof"><span class="nav-number">4.6.1.1.</span> <span class="nav-text">Proof</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E6%9C%80%E5%B0%8F%E5%85%AC%E5%80%8D%E6%95%B0-operatorname-lcm-a-b"><span class="nav-number">4.7.</span> <span class="nav-text">3.2 æœ€å°å…¬å€æ•° $\operatorname{lcm}(a,b)$</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95-text-exgcd"><span class="nav-number">4.8.</span> <span class="nav-text">3.3 æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• $\text{exgcd}$</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-1-%E7%94%A8-text-exgcd-%E6%B1%82%E8%A7%A3%E7%9A%84%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98"><span class="nav-number">4.8.1.</span> <span class="nav-text">3.3.1 ç”¨ $\text{exgcd}$ æ±‚è§£çš„ä¸€ä¸ªé—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-2-%E6%9C%89%E7%90%86%E6%95%B0%E5%8F%96%E4%BD%99%EF%BC%9A%E7%94%A8-text-exgcd-%E6%B1%82%E8%A7%A3%E7%9A%84%E5%8F%A6%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98"><span class="nav-number">4.8.2.</span> <span class="nav-text">3.3.2 æœ‰ç†æ•°å–ä½™ï¼šç”¨ $\text{exgcd}$ æ±‚è§£çš„å¦ä¸€ä¸ªé—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-3-text-exgcd-%E4%BE%8B%E9%A2%98"><span class="nav-number">4.8.3.</span> <span class="nav-text">3.3.3 $\text{exgcd}$ ä¾‹é¢˜</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E6%95%B0%E8%AE%BA%E5%88%86%E5%9D%97"><span class="nav-number">4.9.</span> <span class="nav-text">4 æ•°è®ºåˆ†å—</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E7%AE%97%E6%B3%95"><span class="nav-number">4.9.1.</span> <span class="nav-text">4.1 ç®—æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E4%BE%8B%E9%A2%98"><span class="nav-number">4.9.2.</span> <span class="nav-text">4.2 ä¾‹é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-%E7%94%A8%E6%95%B0%E8%AE%BA%E5%88%86%E5%9D%97%E8%A7%A3%E5%86%B3%E7%9A%84%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98"><span class="nav-number">4.9.3.</span> <span class="nav-text">4.3 ç”¨æ•°è®ºåˆ†å—è§£å†³çš„ä¸€ä¸ªé—®é¢˜</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference"><span class="nav-number">5.</span> <span class="nav-text">- Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="TheSky233"
      src="https://cdn.luogu.com.cn/upload/usericon/501865.png">
  <p class="site-author-name" itemprop="name">TheSky233</p>
  <div class="site-description" itemprop="description">An OIer / PhOer</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/TheSky233" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;TheSky233" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1602458048@qq.com" title="E-Mail â†’ mailto:1602458048@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.luogu.com.cn/user/501865" title="https:&#x2F;&#x2F;www.luogu.com.cn&#x2F;user&#x2F;501865" rel="noopener" target="_blank">TheSky233's Luogu</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">TheSky233</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">67k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">1:01</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>


  




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>














  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
